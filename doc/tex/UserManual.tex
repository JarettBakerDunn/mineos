\documentclass[11pt]{article}
\usepackage[dvips]{graphicx}
\oddsidemargin 0in
\textheight 9.in
\textwidth 6.5in
\topmargin -0.50in
\parskip .29cm
\renewcommand{\baselinestretch}{1.2}
\baselineskip 1.2cm
\newenvironment{references}[0]{
\parindent -15pt}{}
%
\newcommand{\dfrac}{\displaystyle \frac}
\newcommand{\vred}{\vspace {-0.1in}}

\begin{document}

\vspace{30pt}

\title{\vspace{20pt}
{\bf \Huge The Mineos Package}\\
{\bf V 1.0}  \\
{\bf \emph{by}} \\
{\bf \emph{Guy Masters}} \\
\vspace{25pt}
{\bf User's manual} \\
\vspace{42pt}
\vspace{100pt}
\vspace{100pt}
}
\author{
Software Package and Documentation Prepared by:\\
Misha Barmine\\
University of Colorado at Boulder\\
Send comments, questions, suggestions to:
\textbf{\emph{barmin@ciei.colorado.edu}}  \\ \\
\large Funding and Support Provided By: \\
\large Computational Infrastructure for Geodynamics (CIG)\\ \normalsize}

\date {{November 26, 2006}}

\maketitle


\newpage

\renewcommand{\baselinestretch}{1.0}
\tableofcontents
\renewcommand{\baselinestretch}{1.2}

\newpage

\section{Mineos Package Overview}

The {\bf Mineos Package}, by Guy Masters, consists of four programs:
{\bf minos\_bran, eigcon, green,} and {\bf syndat}. Functionally,
the programs break into two sub-groups. The first sub-group contains
the programs that produce the normal mode eigenfunctions and eigenfrequencies,
{\bf minos\_bran} and {\bf eigcon}. Information flow into and out of these
two programs, which we call the {\it eigenfunction system},
is summarized in Figure 1. The second sub-group, referred to as the
{\it synthetic seismogram system}, comprises
the programs that read the output from {\bf eigcon} and compute Green
functions and synthetic seismograms. These programs are {\bf green}
and {\bf syndat} and information flow through these programs is
summarized in Figure 2.

The four programs are executed in sequence.
Some of the the most important files that are produced along the way 
and at the end are formatted into an extension of the CSS-3.0 relational
data base schema. Each file is an ascii flat file that can be read
with a text editor, but has the advantage of also being subsumable into
a data base system such as ORACLE, Postgress, MySql, or Antelope. 
This {\it multi-tiered access} is a design goal of the I/O system
of the {\bf Mineos} package. The potential disadvantage of using
the relational database framework is that the files in the schema
are formatted ascii files that are better generated programmatically
than by hand.

Under the CSS schema, the files are identified by a database 
name ({\it dbname}) and an
suffix that specifies a particular type of file (or relation). An
example would be ${\it mineos.site}$, which is a site table (or
relation) for the data base named {\it mineos}. To
the many users of Antelope, some of these files will be transparent as
they are part of the core CSS-3.0 definition. Examples include
the {\it .site}, {\it sitechan}, and {\it .wfdisc} relations. Other
tables are extensions to CSS, such as the {\it .eigen} relation which
contains parametric information for the eigenfunctions and points to
a much larger direct access file containing the eigenfunctions.
The package does not slavishly adhere to CSS, however. For example,
event information is summarized into a single flat file that summarizes
the information that would be contained in
the {\it .origin, .centryd}, and {\it .moment} relations in
CSS. The input 1D model file also is not part of the CSS schema.
File formats, therefore, are a hybrid with CSS and extensions
to the CSS core.

The final output synthetic seismograms are represented by a {\it .wfdisc}
relation, which points to binary waveform files. The synthetic, therefore,
can be read and displayed by Antelope programs such as {\it dbpick} or
{\it dbe}. The binary waveform files themselves, however, can be
converted upon completion into the SAC format,
with the SAC headers sufficiently populated so that the SAC program can
be used to read in, manipulate, and display the waveforms. Such
multi-tiered access is designed to facilitate user interaction with the
synthetics.

\subsection{Eigenfunction System of Programs}

%Figure 1
\begin{figure}
\begin{center}
\includegraphics[width=5in]{Figures/Fig1}
\caption{Summary of information flow through the eigenfunction system of
programs comprising {\bf minos\_bran} and {\bf eigcon}.}
\label{fig:1}
\end{center}
\end{figure}

The program {\bf minos\_bran} is the work-horse of the {\bf Mineos} Package.
Given a 1D model of the earth and the normal mode band of interest (defined
in terms of a range of frequencies ({\it fmin, fmax}) and normal mode
indices ({\it nmin, nmax, lmin, lmax})), {\bf minos\_bran} computes and outputs the
eigenfunctions and eigenfrequencies of the model for spheroidal, toroidal,
or radial modes (optionally). The output from {\bf minos\_bran}
is in an informally defined pair of files, one an ascii file containing
the input model and output normal mode parameters and the other a binary file
containing the eigenfunctions from the free surface to the earth's center.
The size of the output depends on {\it fmax}, the highest
desired frequency, and the number of radial knots in the input model
file. If the desired frequencies extend to periods as short as
6 sec, the eigenfunctions and eigenfrequencies of more than 150,000 spheroidal 
and 100,000 toroidal modes will be computed if all dispersion branches
are chosen. 

The eigenfunctions themselves may be interesting to some users if sensitivity
kernels, for examples, are desired. The normalization of the eigenfunctions
that emerge from program {\bf minos\_bran} is discussed in section 3.

The program {\bf eigcon} repackages the eigenfunctions in two principal
ways. It, first, renormalizes the eigenfunctions and, second, truncates
the tabulation to extend only to a cut-off depth which is intended to be
the depth of the deepest earthquake considered. This truncation greatly
reduces the size of the eigenfunction file and speeds computation of the
Green functions. In addition, {\bf eigcon}
reformats the output eigenfunction file into a binary file that is
much more independent of computer architecture than that which emerges from
{\bf minos\_bran}.

The final output is represented more formally than the output from
{\bf minos\_bran}, based on the {\it .eigen} relation, which points
to the eigenfunction file on disk. The {\it .eigen} table is an extension of the CSS
database schema. 



\subsection{Synthetic Seismogram System of Programs}

%Figure 2
\begin{figure}
\begin{center}
\includegraphics[width=5in]{Figures/Fig2}
\caption{Summary of information flow through the synthetic seismogram system of
programs comprising {\bf green} and {\bf syndat}.}
\label{fig:2}
\end{center}
\end{figure}

Synthetic seismograms are produced in two stages. In the first stage, program {\bf green}
computes Green functions and, in the second stage, program {\bf syndat}
transforms the Green functions to synthetic seismograms by convolving them with
a centroid moment tensor and input event half-rise time.

Program {\bf green} computes the Green function for an event at an input depth.
The primary input is the {\it .eigen} relation(s) output
from {\bf eigcon}. Typically, there may only be two {\it .eigen} files
input, one for spheroidal and another for toroidal modes. Radial modes
could constitute another input file. However, the input is sufficiently
flexible to allow the user to separate the input eigenfunctions into more
files, if desired. It is up to the user to ensure that the files contain
unique normal modes, however.
The stations and channels for which Green functions are produced by
program {\bf green} are driven by the input {\it .sitechan} table. The
{\it .site} table is also needed by {\bf green} to provide
the station coordinates. The {\it .sitechan} table, therefore,
must contain all and only those stations and channels desired by the user.
The user must strictly adhere to the format of these files. A natural way
to do this is to order a dataless (or data-full) SEED volume (for example
from the IRIS DMC) for the stations of interest, and run RDSEED or an Antelope product
(e.g., sd2de, seed2db) to convert to the two CSS tables. Event coordinates and depth
are contained in an unformatted, single lines file that we call {\it cmt\_event}.
This file must be created and input into program {\bf green} and {\bf syndat}.

The output of program {\bf green} is a {\it .wfdisc} file (in the CSS-3.0
data base schema) in which each row corresponds
to a given station:channel pair and points to the Green function on disk. Antelope
products can be used to view the Green functions in which each
station:channel set of six waveforms is multiplexed into
a single waveform.

Program {\bf syndat} convolves the Green functions pointed to
by the {\it .wfdisc} relation that emerges from {\bf green}
with the centroid-moment tensor and half-rise time of the chosen
event that is contained in file {\it cmt\_event}. The output
is a {\it .wfdisc} in which each row corresponds to a single
station:channel pair and points to the associated waveform on disk presented
in velocity ground units (nm/sec). Transfer functions to convert
to instrument counts for direct comparison with data are not part
of the package.




\subsection{Getting Started}

There are examples for running the four programs in section 10.
In addition, to help the user get started, the standard installation comes with several
input files.

\begin{description}
\item {\bf Model files}. Four model files are presented: {\bf prem\_noocean.txt, prem\_ocean.txt,
NRussia.txt, CPacific.txt}. The first two are for PREM, one with an ocean and the other
in which the ocean has been filled with solid crust. The other two model files are
a continental and an ocean point, in N. Russia and the C. Pacific, respectively. The model in the
latter two cases is the CU-Boulder 3-D model in the top 400 km, a 3-D model from Harvard 
through the rest of the mantle, underlain by PREM in the core, presented on a 2x2 deg
grid world-wide.
\item {\bf Eigenfunction files}. Output from {\bf eigcon} is presented for the
1D model PREM without an ocean. There are spheroidal and toroidal files. For
spheroidal modes, there is {\bf prem\_noocean\_S.eigen}
with the associated eigenfunction file that's contained in the directory {\bf
prem\_noocean\_S.eigen.dat},
simply called {\bf eigen}. Similarly, for toroidal modes there is {\bf prem\_noocean\_T.eigen}
and directory {\bf prem\_noocean\_T.eigen.dat}.
Eigenfunctions are computed with the following characteristics:
(fmin, fmax) = (0, 125.0 mHz), (nmin, nmax) = (1, 30), (lmin, lmax) = (1, 1631). This
produces all toroidal and the vast majority of spheroidal modes up to 8 sec period. There
are about 28,000 spheroidal and 28,000 toroidal modes. Truncation depth of the eigenfunctions is 1000 km.
The eigen files for the spheroidal
and toroidal modes are about 52 and 22 Mb,
respectively.
\item {\bf Event files}. There is a single event file called {\bf china\_cmt\_event.txt} 
  that contains Harvard CMT information for an event in Southern China.
\item {\bf Station:Channel files}. Two sets of station:channel files are included: (1) 
{\bf long.site} and {\bf long.sitechan} and (2) {\bf short.site} and {\bf short.sitechan}. 
The ``long" files are a long list of about 150 stations and
the ``short" list is about 15 stations at various distances from the event S. China.
\end{description}


\subsection{Utilities}
Currently we provide four utilities: {\bf cucss2sac}, {\bf eigen2asc},
{\bf endi}, {\bf simpledit}, and {\bf creat\_origin}.
%
\begin{itemize}
\item {\bf cucss2sac} converts synthetic waveforms represented in CSS3.0 
  (i.e., {\it .wfdisc} relation pointing to binary formatted waveforms on disk) 
  into SAC or ASCII formatted waveform files. Note that seismological coommunity provides us
  with another CSS to SAC converters, and you may use them for your own risk. For example,
  for the SUN platform, the distribution set
  {\tt css2sac-3.0.3.tar.z} is 
  available from {\it http://www.iris.edu}. The utility from that
  site, however,  doesn't work under Linux or Windows platforms. 
  The bugs are fixed in the {\tt css2sac\_082006.zip} package which is 
  available from {\it http://www.sunrisear.com/download.html}.
\item{\bf eigen2asc} prints out on a standard output device  requested 
  eigenfunctions from {\it .eigen} relation (CSS3.0 extension). 
  The eigenfunctions might be requested by order numbers, (n, l), or by 
  (n, T). In second case {\bf eigen2asc} matches the
  order number l with the closest period to T. Output might be redirected 
  to file for further usage.
\item  {\bf endi} swaps order of words bytes in binary files. The length
  of word is any integer number, for example, 2, 4, 6, 16, etc. 
  {\bf endi} might be used for BIG\_ENDIAN-LOW\_ENDIAN
  binary data conversation. Note, that this program upgrades files in place.
\item  {\bf simpledit} is a simple filter program. It converts a manually 
  created (text editor) unformatted ascii file with station and
  channel information into CSS3.0 {\it .site} and {\it .sitechan} relation
  tables.
\item {\bf creat\_origin} is a shell script  that converts an event 
  file (e.g., {\bf china\_cmt\_event.txt}) into the CSS3.0 {\it .origin} 
  relation.
\end{itemize}
For more details see Section 7 of this Manual.


\section{{\bf Mineos} system requirements}
\begin{itemize}
\item 32-bit processor (64-bit is recommended).
\item Unix Operating System.
\item 512 MB of RAM.
\item FORTRAN 77 and C compilers. Currently, the {\bf Mineos} package was
tested under SunOS 5.7/f77/cc and under Linux RedHat/f77/g77.
\item At least 1 GB of available hard-disk space.
\item autoconf 2.59 or higher version and automake 1.8.4 or higher version.
This requirement is only for software developers.
\end{itemize}

\section {minos\_bran program}

{\bf minos\_bran} program produces the solution of the seismic normal mode
eigenvalue-eigenfunction problem.
The program evaluates the eigenvalues and eigenfunctions for radial, spheroidal (S) and
toroidal (T) modes. The model of the earth is  self-gravitating, spherically
symmetric, transversely isotropic, and attenuative. \\
\noindent {\bf minos\_bran} is written in the FORTRAN-77 language.
\subsection {Command line}

\noindent {\bf minos\_bran}

\noindent {\bf minos\_bran} $<$ {\it parameter\_file}

\noindent {\bf minos\_bran} $<<$ WORD \\
\noindent ........  \\
\noindent ........  \\
\noindent WORD

\noindent There are three different ways to start the {\bf minos\_bran} program:
\begin{itemize}
\item interactive dialog for setting input parameters;
\item single shell command with redirection of the standard input to the parameter
file {\it parameter\_file} containing exactly the same information and
in the same order as an interactive dialog - one answer per line;
\item direct shell script. In this case, the contents of the parameter file are 
directly included into the shell script between the delimiters ``WORD". See examples.
\end{itemize}

\noindent The parameter file consists of six lines:
\begin{description}
\item[Line 1:] {\it model\_file} \\
{\it model\_file} is the path to the 1-D input model file. Text string up to 
256 characters long.
\item[Line 2:] {\it out\_plain\_file} \\
{\it out\_plain\_file} is the path to the output ASCII file. The file contains a model
listing  and a summary of mode properties. Text string up to 256 
characters long.
\item[Line 3:] {\it out\_bin\_file} \\
{\it out\_bin\_file} is the  path to the output FORTRAN unformatted binary file.
The file is a collection of eigenfunctions in a binary representation. 
The file name ``none" is a special name. ``none" will suppress the calculation 
of eigenfunctions. Text string up to 256 characters long.
\item[Line 4:] {\it eps, wgrav} \\
Parameter {\it eps} controls the accuracy of the 
Runge-Kutta integration scheme. The relative accuracy of an eigenfrequency 
is a factor 2-3 times {\it eps}. {\it eps} also controls the precision with 
which a root is found and the minimum relative separation of two roots 
with the same angular order. It is safe to set $eps = 10^{-7}$ for periods
greater than 10 seconds. For periods between 5 and 10 seconds, it has to be
set to $10^{-12} - 10^{-10}$. {\it wgrav} is the frequency in millihertz (mHz)
above which gravitational terms are neglected - this gives about a factor 
of 3 increase in speed. {\bf Format:} unformatted.
\item[Line 5:] {\it jcom} \\
{\it jcom} is the type of oscillation.  $jcom=1$ for radial modes, $=2$ for
toroidal modes, $=3$ for spheroidal modes, and $=4$ for inner core toroidal
modes. {\bf Format:} unformatted.
\item[Line 6:] {\it lmin, lmax, wmin, wmax, nmin, nmax} \\
$lmin,\; lmax$ define the range 
of angular orders $l$ to be computed. For radial modes, $jcom=1$,
$lmin,\; lmax$ are read in but are not used. $wmin,\;  wmax$
define the frequency range to be computed (in milli-Hertz). $nmin,\;nmax$ 
specify the range of dispersion branch numbers $n$ to be computed. $n = 0$ is the 
fundamental mode. {\bf Format:} unformatted.
\end{description}
%
% Input data
%
\subsection {Input data}

\textbf{\large \emph{model\_file.}} The model file is a plain ASCII file that may be
either given in tabular or polynomial form. The first two lines in the model file 
are common. The rest of the file depends on the setting and file type. 
A more detailed description of the model file is:
\begin{description}
\item[Line 1:] {\it title} \\
Any text up to 80 characters long.
\item[Line 2:] {\it ifanis, tref, ifdeck} \\
$ifanis=1$ for an anisotropic (transversely isotropic)
model, $=0$ for isotropic. $tref$ is the reference period (seconds) of the
model for the physical dispersion correction. If $tref \leq 0$ no correction is made.
The parameter $ifdeck$ defines the type of model.
If $ifdeck=1$, the model is presented in tabular form. If $ifdeck=0$, the
model is presented as a polynomial.
\end{description}
%
% Tabular model
%
{\large\it Tabular Setting,} {\it $ifdeck=1$}.
\begin{description}
\item[Line 3:] {\it N, nic, noc} \\
$N$ is the number of model knots and $N \leq 350$. $nic$ is the 
index of the solid side of the inner core boundary (ICB). $noc$ is the index of the
fluid side of the mantle core boundary (MCB). 
%Note that $n$ must be $\leq 223$. (mhr)
{\bf Format:} unformatted.
\item[Lines 4$\;-\;(N+3)$:] {\it r, rho, vpv, vsv, qkappa, qshear, vph, vsh, eta} \\
Each line describes the model parameter set for a single knot at radius $r$. 
Note that each knot has an integer index starting from 1, where the index is
equal to the line number minus 3. The discontinuity interfaces are
defined by a pair of knots at the same radius. \\
The line fields are:
\begin{itemize}
\item[{\it r}] - radius of the knot in meters (m). {\bf minos\_bran}
truncates the fractional part of radius, so a layer with thickness less that 1 m 
does not make any sense. Introducing thin layers (less than 1 m) leads to 
creating additional interfaces. If the model includes a surface liquid layer,
it must be a single layer without intermediate knots.
Radius starts from zero (index$=1$) and ends at the free surface,
growing from the center of the earth outward.
\item[{\it rho}] - density, ($\rm kg/m^3$)
\item[{\it vpv}] - velocity of vertically polarized P wave, (m/s)
\item[{\it vsv}] - velocity of vertically polarized S wave, (m/s)
\item[{\it qkappa}] - compressional Q
\item[{\it qshear}] - shear Q
\item[{\it vph}] - velocity of horizontally polarized P, (m/s)
\item[{\it vsh}] - velocity of horizontally polarized S, (m/s)
\item[{\it eta}] - transversely isotropic model parameter
\end{itemize}
If the model is isotropic, $ifanis = 1$ and {\bf minos\_bran} reads and changes
the values of {\it vph, vsh} and {\it eta} field in the following way:
$ vph=vpv,\;vsh=vsv$, and $eta=1$.
If both $qkappa$ and $qshear$ are equal to zero, the $Q$ model is not specified for the
knot and no correction for attenuation is made.\\
{\bf Format:} (f8.0, 3f9.2, 2f9.1, 2f9.2, f9.5)
\end{description}
%
% Polynomial model
%
{\large\it Polynomial Setting,} {\it $ifdeck=0$}.
\begin{description}
\item[Line 3:] {\it nreg, nic, noc, rx} \\
$nreg$ is the number of regions in the model, $nic$ and $noc$ have the same meaning
as for the tabular model, $rx$ is the normalizing radius for the polynomials.
$rx$ is given in (km) and it is usually 6371 km. {\bf Format:} unformatted.
\item[Line 4:] {\it nlay,r1,r2} \\
$nlay$ is the number of levels (layers) to be used in the region extending
from radius $r1$ to $r2$, $r1$ to $r2$ are  in (km). {\bf Format:} unformatted.
%
\item[Lines 5-9 or 5-12:] Lines 4-9 or 4-12 must be repeated $nreg$ times.
Lines 4-9 must be repeated for the isotropic model and lines 4-12
for the anisotropic model. Each line consists of five
coefficients $a_0,\;a_1,\;a_2,\;a_3,\;a_4$ for the fourth order polynomial 
$P(x)=a_0+a_{1}x+a_{2}x^2+a_{3}x^3+a_{4}x^4$, where, $x=r/rx$.
A set of 5 or 8 polynomials is used for interpolating the model parameters:
density, velocities, etc.,
as a function of normalized radius inside the region defined by line 4.
{\bf Format:} (5f9.5). More detail:
\item[Line 5:] Coefficients for density $rho$, ($\rm g/cm^3)$
\item[Line 6:] Coefficients for $vpv$, ($\rm km/s)$
\item[Line 7:] Coefficients for $vsv$, ($\rm km/s)$
\item[Line 8:] Coefficients for $qkappa$
\item[Line 9:] Coefficients for $qshear$
\item[] Three next lines must be added for an anisotropic model.
\item[Line 10:] Coefficients for $vph$, ($\rm km/s)$
\item[Line 11:] Coefficients for $vsh$, ($\rm km/s)$
\item[Line 12:] Coefficients for $eta$
\end{description}

\subsection {Output data}
{\bf minos\_bran} outputs an ASCII listing file and a FORTRAN unformatted
binary file. The first file contains the model table and the normal mode properties 
and the second contains the eigenfunctions.

\noindent \textbf{\large \emph{out\_plain\_file.}}
The file consists of two parts:
\begin{description}
\item[Part 1:] Model table. The model output is always in tabular form.
If the input model is in tabular form, the output model is just a 
copy except that knots are given indices and
columns are placed in a different order. For an isotropic model, $vph$ 
will be replaced on $vpv$,  $vsh$ on $vsv$, and $eta=1$.
If the input model is in polynomial form,
the model is converted to tabular form by interpolation across
region layers. For each region, the program constructs $nlay+1$ knots with a
constant step in radius.
The total number of knots $N$ is equal to $nreg \cdot (nlay+1)$.
Lines from the beginning of the file look as follows:
\begin{description}
\item[Lines] 1-5: Contains the model $title$, reference period $tref$,
header for the model table, and empty lines. {\bf Format:} no format.
\item[Lines] $6\;-\; (N+5)$: {\it index, r, rho, vpv, vph, vsv, vsh, 
eta, dshear, qkappa}\\
where $index$ is the knot number, starting from 1. The content of the 
remaining fields is described in section 3.2. {\bf Input data}. \\
{\bf Format:} (3x, i3, f12.1, 5f12.2, f12.5, 2f12.2)
\item[Lines] $N+6 \div \; N+11$: Contains text messages with Runge-Kutta
precision integration, gravity cut off frequency, empty lines, and the header
for the normal mode properties table (totaling 6 lines).\\
{\bf Format:} free.
\end{description}
\item[Part 2:] Mode properties. For a fixed radial order number $n$ and 
angular order $l,$ {\bf minos\_bran} computes the eigenfunctions (stored
separately) and the scalar parameters (properties): eigenvalue (frequency),
phase and group velocities, $Q$ and ratio of kinetic to potential energy.
These scalar parameters are stored in the the normal mode properties table. Each row
(line) in this table gives the properties for the current $n$ and $l$.
Lines following the first part look as follows:
\begin{description}
\item[Lines] $(N+12)\;-$ end: {\it norder, typeo, lorder, phvel, freq, per, grvel, Q, raylquo,} \\
where,
\begin{itemize}
\item[{\it norder}] - mode radial order number $n$
\item[{\it typeo}] - type of oscillation (single character): s - spheroidal, t - toroidal, c - inner
core toroidal
\item[{\it lorder}] - mode angular order number $l$
\item[{\it phvel}] - phase velocity, (km/s)
\item[{\it freq}] - frequency (eigenvalue), (millihertz,mHz)
\item[{\it per}] - period, per = 1000/freq, (sec)
\item[{\it grvel}] - group velocity, (km/s)
\item[{\it Q}] - shear Q
\item[{\it raylquo}] - ratio of kinetic to potential energy
minus 1 which should be small (of order $eps$), if the eigenfunction is
accurate and if there are enough radial knots in the model to allow
quadratures to be done accurately. (You will probably see some degradation
in this parameter for strongly exponential modes such as Stoneley modes ). \\
\end{itemize}
{\bf Format:} (i5, a2, i5, 6g16.7)
\end{description}
\end{description}
\noindent \textbf{\large \emph{out\_bin\_file.}} This is a fixed record length
binary encapsulated file. The file is not portable, which means that the type
of encapsulation strongly depends on the compiler. For example, if the file
was created on a SUN platform by the f77 compiler, it cannot be read by a progam
created by the g77 compiler on the same platform. To avoid this inconvenience,
the program {\bf eigcon} removes encapsulation and creates a binary file
portable between different languages and platforms. \\
{\bf minos\_bran} outputs each  et of the eigenfunctions with a single write 
statement\t:
\begin{quote}
\texttt{real*4 abuf(nvec)} \\
\texttt{.....} \\
\texttt{write(ioeig) (abuf(i),i$=$1,nvec)} 
\end{quote}
where nvec is $5+6*N$ words long for spheroidal modes and $5+2*N$ words long 
for other modes. The first five words of abuf are $n,l,\omega, Q$, and
group velocity $C_g$. The rest of \texttt{abuf} contains eigenfunctions and their
derivatives by radius - 
$U$(1..N), $U^\prime$(1..N), $V$(1..N), $V^\prime$(1..N),
$P$(1..N), $P^\prime$(1..N) for spheroidal modes and
$W$(1..N), $W^\prime$(1..N)
for other modes. Here, $U$ is the eigenfunction for the vertical spheroidal (S) component,
$V$ for the horizontal S component, $P$ is the gravitational potential. $W$ is the
common notation for modes other than S.\\
Eigenfunctions are stored in normalized form.
The normalization of eigenfunctions is given by 
\[       \omega^2 \int_0^{r_n} \rho(r)\; W^{2}(r)r^{2}\;dr = 1 \]
for toroidal modes and
\[       \omega^2 \int_0^{r_n} \rho(r)\; [U^{2}(r)+V^{2}(r)]r^{2}\;dr = 1 \]
for spheroidal modes. \\
Note that $r, \omega, \rho, V, U, W$ in the two formulas above are normalized such 
that a density of $\rho_n=5515$ $\rm kg/m^3$ is 1,
$\pi g$ is 1, where, $G$ is the gravitational constant $G=6.6723\cdot 10^{-11}$
$m^{3}/kg/s^2$, 
and the radius $r_n$ of the free surface is 1. These normalizations result in:
\begin{center}
\begin{tabular}{rl}
acceleration normalization: & $a_n=10^{20}/(\rho_n r_n^4)$; \\
velocity normalization:     & $v_n=r_n\;(\pi G\rho_n)^{-1/2}$; \\
frequency normalization:    & $\omega_n=v_n/r_n$; \\
radius normalization:       & $r_n$. \\
\end{tabular}
\end{center}

\subsection {Messages}
Program {\bf minos\_bran} prints out on the standad output dialog
messages only. See an example in section 10.1 (Interactive dialog).

%1. \texttt{in remedy with start level :   ??}

\include{eigcon}
\include{green}
\include{syndat}
\include{utilities}
\include{fun}
\include{tab}
\include{examples}
\section* {References}
\addcontentsline{toc}{section}{References} 

\begin{description}
\item[] Anderson, J., Farrell, W.E., at all. Center for Seismic
Studies version 3 database: Schema reference manual. Technical Report
C90-01, DARPA, September 1990.
\item[] Biswas, N.N., Knopoff L., 1970. Exact earth-flattening calculations
for Love wave. {\it Bull. Seismol. Soc. Amer.}, {\bf 60}, 1123-1127.
\item[] Biswas, N.N., 1972. Earth-flattening procedure for propagation of
Rayleigh wave. {\it PAGEOPH}, {\bf 96}, 61-74.
\item[] Gilbert, F., Dziewonski, A.M., 1975. An application of normal
mode theory to the retrieval of structural parameters and source mechanisms
from seismic spectra. {\it Phil. Trans. R. Soc}., {\bf A278}, 187-269.
\item[] Herrmann, R.B., 1978. {\it Computer programs in earthquake seismology.}
Vol. {\bf 2}, St. Louis: St. Louis University.
\item[] Woodhouse, J.H., Dahlen, F.A., 1978. The effect of  a general aspherical
perturbation on the free oscillation of the Earth. {\it Geophys. J.R.
astr Soc.}, {\bf 53}, 335-354.
\item[] SPECFEM3D\_GLOBE, Version 3.6. User Manual. CIG/CIT, October 24, 2006
\end{description}
%
% MAKE APPENDIX
\appendix
\makeatletter
\def\@seccntformat#1{\csname Pref@#1\endcsname \csname the#1\endcsname\quad}
\def\Pref@section{Appendix~}
\makeatother

\include{model}
\include{benchmark}
\include{frame}
\end{document}
